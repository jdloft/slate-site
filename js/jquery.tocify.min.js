!function(t){"use strict";!function(t,e,s,i){var o=".tocify-header",n=".tocify-subheader";t.widget("toc.tocify",{version:"1.9.0",options:{context:"body",ignoreSelector:null,selectors:"h1, h2, h3",showAndHide:!0,showEffect:"slideDown",showEffectSpeed:"medium",hideEffect:"slideUp",hideEffectSpeed:"medium",smoothScroll:!0,smoothScrollSpeed:"medium",scrollTo:0,showAndHideOnScroll:!0,highlightOnScroll:!0,highlightOffset:40,theme:"bootstrap",extendPage:!0,extendPageOffset:100,history:!0,scrollHistory:!1,hashGenerator:"compact",highlightDefault:!0},_create:function(){var s=this;s.tocifyWrapper=t(".tocify-wrapper"),s.extendPageScroll=!0,s.items=[],s._generateToc(),s.cachedHeights=[],s.cachedAnchors=[],s._addCSSClasses(),s.webkit=function(){for(var t in e)if(t&&-1!==t.toLowerCase().indexOf("webkit"))return!0;return!1}(),s._setEventHandlers(),t(e).load(function(){s._setActiveElement(!0),t("html, body").promise().done(function(){setTimeout(function(){s.extendPageScroll=!1},0)})})},_generateToc:function(){var e,s,i=this,o=i.options.ignoreSelector;(e=-1!==this.options.selectors.indexOf(",")?t(this.options.context).find(this.options.selectors.replace(/ /g,"").substr(0,this.options.selectors.indexOf(","))):t(this.options.context).find(this.options.selectors.replace(/ /g,""))).length?(i.element.addClass("tocify"),e.each(function(e){t(this).is(o)||(s=t("<ul/>",{id:"tocify-header"+e,class:"tocify-header"}).append(i._nestElements(t(this),e)),i.element.append(s),t(this).nextUntil(this.nodeName.toLowerCase()).each(function(){0===t(this).find(i.options.selectors).length?t(this).filter(i.options.selectors).each(function(){t(this).is(o)||i._appendSubheaders.call(this,i,s)}):t(this).find(i.options.selectors).each(function(){t(this).is(o)||i._appendSubheaders.call(this,i,s)})}))})):i.element.addClass("tocify-hide")},_setActiveElement:function(t){var s=e.location.hash.substring(1),i=this.element.find('li[data-unique="'+s+'"]');return s.length?(this.element.find("."+this.focusClass).removeClass(this.focusClass),i.addClass(this.focusClass),this.options.showAndHide&&i.click()):(this.element.find("."+this.focusClass).removeClass(this.focusClass),!s.length&&t&&this.options.highlightDefault&&this.element.find(".tocify-item").first().addClass(this.focusClass)),this},_nestElements:function(e,s){var i,o,n;return(i=t.grep(this.items,function(t){return t===e.text()})).length?this.items.push(e.text()+s):this.items.push(e.text()),n=this._generateHashValue(i,e,s),o=t("<li/>",{class:"tocify-item","data-unique":n}).append(t("<a/>",{text:e.text()})),e.before(t("<div/>",{name:n,"data-unique":n})),o},_generateHashValue:function(t,e,s){var i="",o=this.options.hashGenerator;if("pretty"===o){for(i=(i=e.text().toLowerCase().replace(/\s/g,"-")).replace(/[^\x00-\x7F]/g,"");i.indexOf("--")>-1;)i=i.replace(/--/g,"-");for(;i.indexOf(":-")>-1;)i=i.replace(/:-/g,"-")}else i="function"==typeof o?o(e.text(),e):e.text().replace(/\s/g,"");return t.length&&(i+=""+s),i},_appendSubheaders:function(e,s){var i=t(this).index(e.options.selectors),o=t(e.options.selectors).eq(i-1),a=+t(this).prop("tagName").charAt(1),h=+o.prop("tagName").charAt(1);a<h?e.element.find(n+"[data-tag="+a+"]").last().append(e._nestElements(t(this),i)):a===h?s.find(".tocify-item").last().after(e._nestElements(t(this),i)):s.find(".tocify-item").last().after(t("<ul/>",{class:"tocify-subheader","data-tag":a})).next(n).append(e._nestElements(t(this),i))},_setEventHandlers:function(){var o=this;this.element.on("click.tocify","li",function(s){if(o.options.history&&(e.location.hash=t(this).attr("data-unique")),o.element.find("."+o.focusClass).removeClass(o.focusClass),t(this).addClass(o.focusClass),o.options.showAndHide){var i=t('li[data-unique="'+t(this).attr("data-unique")+'"]');o._triggerShow(i)}o._scrollTo(t(this))}),this.element.find("li").on({"mouseenter.tocify":function(){t(this).addClass(o.hoverClass),t(this).css("cursor","pointer")},"mouseleave.tocify":function(){"bootstrap"!==o.options.theme&&t(this).removeClass(o.hoverClass)}}),(o.options.extendPage||o.options.highlightOnScroll||o.options.scrollHistory||o.options.showAndHideOnScroll)&&(t(e).on("resize",function(){o.calculateHeights()}),t(e).on("scroll.tocify",function(){t("html, body").promise().done(function(){var n,a,h,l,c=t(e).scrollTop(),r=t(e).height(),d=t(s).height(),f=t("body")[0].scrollHeight;if(o.options.extendPage&&(o.webkit&&c>=f-r-o.options.extendPageOffset||!o.webkit&&r+c>d-o.options.extendPageOffset)&&!t(".tocify-extend-page").length){if(!(a=t('div[data-unique="'+t(".tocify-item").last().attr("data-unique")+'"]')).length)return;h=a.offset().top,t(o.options.context).append(t("<div />",{class:"tocify-extend-page",height:Math.abs(h-c)+"px","data-unique":"tocify-extend-page"})),o.extendPageScroll&&(l=o.element.find("li.active"),o._scrollTo(t('div[data-unique="'+l.attr("data-unique")+'"]')))}setTimeout(function(){var a,h=null;0==o.cachedHeights.length&&o.calculateHeights();var l=t(e).scrollTop();if(o.cachedAnchors.each(function(t){if(!(o.cachedHeights[t]-l<0))return!1;h=t}),a=t(o.cachedAnchors[h]).attr("data-unique"),n=t('li[data-unique="'+a+'"]'),o.options.highlightOnScroll&&n.length&&!n.hasClass(o.focusClass)){o.element.find("."+o.focusClass).removeClass(o.focusClass),n.addClass(o.focusClass);var c=o.tocifyWrapper,r=t(n).closest(".tocify-header"),d=r.offset().top,f=c.offset().top,u=d-f;if(u>=t(e).height()){var p=u+c.scrollTop();c.scrollTop(p)}else u<0&&c.scrollTop(0)}o.options.scrollHistory&&e.location.hash!=="#"+a&&a!==i&&(history.replaceState?history.replaceState({},"","#"+a):(scrollV=s.body.scrollTop,scrollH=s.body.scrollLeft,location.hash="#"+a,s.body.scrollTop=scrollV,s.body.scrollLeft=scrollH)),o.options.showAndHideOnScroll&&o.options.showAndHide&&o._triggerShow(n,!0)},0)})}))},calculateHeights:function(){var e=this;e.cachedHeights=[],e.cachedAnchors=[];var s=t(e.options.context).find("div[data-unique]");s.each(function(s){var i=(t(this).next().length?t(this).next():t(this)).offset().top-e.options.highlightOffset;e.cachedHeights[s]=i}),e.cachedAnchors=s},show:function(e,s){if(!e.is(":visible"))switch(e.find(n).length||e.parent().is(o)||e.parent().is(":visible")?e.children(n).length||e.parent().is(o)||(e=e.closest(n)):e=e.parents(n).add(e),this.options.showEffect){case"none":e.show();break;case"show":e.show(this.options.showEffectSpeed);break;case"slideDown":e.slideDown(this.options.showEffectSpeed);break;case"fadeIn":e.fadeIn(this.options.showEffectSpeed);break;default:e.show()}return e.parent().is(o)?this.hide(t(n).not(e)):this.hide(t(n).not(e.closest(o).find(n).not(e.siblings()))),this},hide:function(t){switch(this.options.hideEffect){case"none":t.hide();break;case"hide":t.hide(this.options.hideEffectSpeed);break;case"slideUp":t.slideUp(this.options.hideEffectSpeed);break;case"fadeOut":t.fadeOut(this.options.hideEffectSpeed);break;default:t.hide()}return this},_triggerShow:function(t,e){return t.parent().is(o)||t.next().is(n)?this.show(t.next(n),e):t.parent().is(n)&&this.show(t.parent(),e),this},_addCSSClasses:function(){return"jqueryui"===this.options.theme?(this.focusClass="ui-state-default",this.hoverClass="ui-state-hover",this.element.addClass("ui-widget").find(".toc-title").addClass("ui-widget-header").end().find("li").addClass("ui-widget-content")):"bootstrap"===this.options.theme?(this.element.find(o+","+n).addClass("nav nav-list"),this.focusClass="active"):(this.focusClass="tocify-focus",this.hoverClass="tocify-hover"),this},setOption:function(){t.Widget.prototype._setOption.apply(this,arguments)},setOptions:function(){t.Widget.prototype._setOptions.apply(this,arguments)},_scrollTo:function(e){var s=this.options.smoothScroll||0,i=this.options.scrollTo,o=t('div[data-unique="'+e.attr("data-unique")+'"]');return o.length?(t("html, body").promise().done(function(){t("html, body").animate({scrollTop:t('div[data-unique="'+e.attr("data-unique")+'"]').next().offset().top-(t.isFunction(i)?i.call():i)+"px"},{duration:s})}),this):this}})}(window.jQuery,window,document)}();
